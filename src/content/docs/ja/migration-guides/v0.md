---
title: v0.x
description: v0.x から移行するためのガイド。主に破壊的変更の記録です。
---

## v0.19.0

Context の統合

### c.cronEvent -> c.interaction

```diff lang="ts"
const app = new DiscordHono().cron("", async c => {
-  console.log(c.cronEvent)
+  console.log(c.interaction)
})
```

### CronContext を type 情報のみに変更

## v0.18.0

### c.followupDelete を削除

v0.17.0 -> v0.18.0

```diff lang="ts"
-return c.update().resDefer(c.followupDelete)
+return c.update().resDefer(c => c.followup())
```

v0.16.x 以前 -> v0.18.0

```diff lang="ts"
-return c.resDeferUpdate(c.followupDelete)
+return c.update().resDefer(c => c.followup())
```

## v0.17.0

### c.req と c.waitUntil() を削除

c.req は Hono の c.req と混同される可能性があり、また Discord Bot では Request オブジェクトを扱う必要がないため、削除されました。  
もしこの機能がどうしても必要な場合は、代わりに Hono のミドルウェアを利用することを検討してください。  
どうしても代替手段が見つからず、c.req が必要な場合は Issue を作成してください。

c.waitUntil() は、その機能が c.resDefer() に含まれており、使用頻度も低かったため削除されました。  
代わりに c.executionCtx.waitUntil() を使用してください。

```diff lang="ts"
-c.waitUntil(/*process*/)
+c.executionCtx.waitUntil(/*process*/)
```

### c.resUpdate(), c.resDeferUpdate() -> c.update()

```diff lang="ts"
-return c.resUpdate("update text")
+return c.update().res("update text")
```
```diff lang="ts"
-return c.resDeferUpdate("update text")
+return c.update().resDefer("update text")
```

### c.suppressEmbeds(), c.ephemeral(), c.suppressNotifications() -> c.flags()

```diff lang="ts"
-return c.ephemeral().suppressNotifications().res("ephemeral text")
+return c.flags("EPHEMERAL", "SUPPRESS_NOTIFICATIONS").res("ephemeral text")
```

## v0.16.6

開発者の実装ミスによる意図しない破壊的変更

### fix: c.followup

v0.16.5以前のバージョンでは、followup は [POST](https://discord.com/developers/docs/interactions/receiving-and-responding#create-followup-message) を通して処理されていました。  
v0.16.6以降では、followup は [PATCH](https://discord.com/developers/docs/interactions/receiving-and-responding#edit-original-interaction-response) を通して処理されます。  
これは、意図的に複数回 followup を呼び出している場合にのみ互換性を崩す変更となります。  
そのような場合は、新しい followup を作成するために c.rest を使用してください。

## v0.16.0

### Rest -> createRest

```diff lang="ts"
-const rest = new Rest('token')
+const rest = createRest('token')
```

```diff lang="ts"
-const res = c.rest.post(_channels_$_messages, [channel_id], { content: 'this is rest' })
+const res = c.rest('POST', _channels_$_messages, [channel_id], { content: 'this is rest' })
```

## v0.15.0

### factory.loader -> app.loader

```diff lang="ts"
const app = factory.discord()
-  factory.loader(app, Object.values(handlers))
+  .loader(Object.values(handlers))
export default app
```

## v0.14.0

### Restにおけるgetメソッドの戻り値
```diff lang="ts"
-const { result } = await c.rest.get('/applications/@me', [])
+const result = await c.rest.get('/applications/@me', []).then(r => r.json())
```

## v0.13.0

### 正規表現キーをサポートしない

.component() および .modal() では、正規表現キーの代わりに custom_id を使用してください。  
正規表現キーをどうしても使用する必要がある場合は、[この例](/ja/examples/regex-routing/)を参照してください。

```diff lang="ts"
const app = new DiscordHono()
-  .command(/regex/, c => c.res('regex'))
+  .command('regex', c => c.res('regex'))
```

### ComponentContext の型変更

```diff lang="ts"
-const handler= (c: ComponentContext<Env, 'Button'>) => {
+const handler= (c: ComponentContext<Env, Button>) => {
  //...
}
```

## v0.12.0

### Context の統合
```diff lang="ts"
const func = (c: CommandContext<Env> | ComponentContext<Env>) => {
  //...
-  if (c instanceof CommandContext)
+  if (c.interaction.type === 2)
  //...
}
```
